import{P as a,j as s,u as F,r as m,l as L,Q as S,f as D,b as G,F as P,M as g}from"./index-931e9058.js";import{F as b,a as V,T as E,L as T,E as w,b as M,c as I,I as v,d as O,S as R,e as $}from"./AuthForms.styled-0241d303.js";import{B as U,L as W,G as k,V as z}from"./VerifyForm-03a79348.js";import{a as A,f as Q}from"./clusterSchema-eedc4966.js";const q=({$fs:o,onClick:l,children:d})=>s.jsx(U,{type:"button",$fs:o,onClick:l,children:d});q.propTypes={$fs:a.string,onClick:a.func.isRequired,children:a.oneOfType([a.string,a.node,a.oneOf(["img","png","svg"])]).isRequired};const f={email:"",password:""},B=({setIsFM:o,setEmail:l})=>{const d=F(),[c,u]=m.useState("password"),p=({values:n,errors:t,key:e})=>{const x=!n[e]&&"noValue",h=t[e]?"error":"success";return x||h},i=({errors:n,values:t})=>{const e=Object.keys(n).length;return Object.keys(t).some(h=>!t[h])||e},r=({email:n})=>{l(n),o(!0)},j=(n,t)=>{d(L(n)).unwrap().catch(e=>e.includes("401")&&S.error("Unauthorized")),t.resetForm()};return s.jsx(b,{initialValues:f,validationSchema:A,onSubmit:j,children:({values:n,errors:t})=>s.jsxs(V,{children:[s.jsxs(E,{children:[s.jsx("h2",{children:"Sign in"}),s.jsx(W,{to:"/signup",children:"Don`t have an account?"})]}),Object.keys(f).map(e=>s.jsxs(m.Fragment,{children:[s.jsxs(T,{children:[e.at(0).toUpperCase()+e.substring(1),s.jsx("pre",{children:" "}),s.jsx(w,{name:e,component:"span"}),e==="password"&&s.jsx(q,{onClick:()=>r(n),children:"Forgot your pass?"})]}),s.jsxs(M,{children:[s.jsx(I,{type:e==="password"?c:e,name:e,$validation:p({values:n,errors:t,key:e})}),e==="password"&&s.jsx(v,{toggle:c,setToggle:u}),n[e]&&t[e]&&s.jsx(O,{}),n[e]&&!t[e]&&s.jsx(R,{})]})]},e)),s.jsx($,{disabled:i({values:n,errors:t}),children:"Sign in"}),s.jsx(k,{children:"Sign in with Google"})]})})};B.propTypes={setIsFM:a.func.isRequired,setEmail:a.func.isRequired};const C=({setIsFM:o,email:l})=>{const d=F(),c=({values:i,errors:r})=>{const j=!Object.values(i)[0]&&"noValue",n=Object.values(r).length?"error":"success";return j||n},u=({errors:i})=>Object.keys(i).length,p=i=>{d(D(i)).unwrap().catch(r=>S.error(r.message)),o(!1)};return s.jsx(b,{initialValues:{email:l},validationSchema:Q,onSubmit:p,children:({values:i,errors:r})=>s.jsxs(V,{children:[s.jsx(E,{children:s.jsx("h2",{children:"Get reset link"})}),s.jsxs(m.Fragment,{children:[s.jsxs(T,{children:["Email",s.jsx("pre",{children:" "}),s.jsx(w,{name:"email",component:"span"})]}),s.jsxs(M,{children:[s.jsx(I,{type:"email",name:"email",$validation:c({values:i,errors:r})}),c({values:i,errors:r})==="error"&&s.jsx(O,{}),c({values:i,errors:r})==="success"&&s.jsx(R,{})]})]}),s.jsx($,{disabled:u({errors:r}),children:"Submit"})]})})};C.propTypes={setIsFM:a.func.isRequired,email:a.string.isRequired};const N=()=>{const{user:o}=G(),[l,d]=m.useState(o.email&&!o.verifiedEmail),[c,u]=m.useState(!1),[p,i]=m.useState("");return s.jsxs(P,{$w:"400px",$p:"0",$fd:"column",$jc:"center",children:[s.jsx(B,{setIsFM:u,setEmail:i}),l&&s.jsx(g,{onClick:()=>d(!l),children:s.jsx(z,{userEmail:o.email})}),c&&s.jsx(g,{onClick:()=>u(!c),children:s.jsx(C,{setIsFM:u,email:p})})]})};export{N as default};
